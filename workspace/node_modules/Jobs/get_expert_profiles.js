// By jarij, 
//last time modificated: 8.3.17
const assert = require('assert');

function getExpertProfiles(db, post, callback)
{
    var object;
    var expertProfileArray=[];
    //TODO haku toistenp√§in
    //var finder={function() { return (this.resipient == post['owner'] && this.sender==post['other'] ) } };
    //var finder={'&and':[{'resipient':{'&eq' :post['owner']}},{'sender':{'&eq' :post['other']}}]};
    var finder={'isExpert':true};
    var cursor = db.collection('profile').find(finder);
    cursor.each(function(err, doc) 
    {
        assert.equal(err, null);
        if (doc != null) 
        {
            //var jotain={'user':doc};
           expertProfileArray.push(doc);
        }
        else 
        {                  
            var text=JSON.stringify(expertProfileArray);
            db.close();     
            if(typeof text != 'undefined')
            {
                return callback(text);
            }
            else
            {
                return callback("Couldn't get incoming messages");
            }
        };
                      
    });
        

};

module.exports = getExpertProfiles;