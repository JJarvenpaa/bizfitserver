var assert = require("assert");
function chatRequest(db, post, callback)
{
    var finder={};
    finder['coach']=post['coach'];
    db.collection('chatRequests').findOne(finder,function(err,result)
    {
        assert.equal(null,err);
        if(result==null)
        {
            result={};
            result['coach']=post['coach'];
            result['chatRequests']=[];
        }
        result['chatRequests'].push(post);
        db.collection('chatRequests').save(result,{
            w:0
        },function(err, result) {
            assert.equal(err,null);
            db.close();
            return callback("Chat requested");
        });
    });
    /*
    db.collection('chatRequests').save(post,{
                    w:0
        },function(err,result)
        {
            assert.equal((err, null));
            db.close();
            return callback("Chat requested");
        });*/
}

module.exports = chatRequest;